(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(e){if(e.ep)return;e.ep=!0;const o=s(e);fetch(e.href,o)}})();function X(r){const t=b(r),s=t.part1[1][0]-t.part1[0][0],n=t.part1[1][1]-t.part1[0][1],e=s/n,o=n/s,i=t.part1[1][0]-t.part2[1][0],a=t.part1[1][1]-t.part2[1][1],h=i/a,d=t.part1[0][0]-t.part2[0][0],u=t.part1[0][1]-t.part2[0][1],D=d/u,f=t.part2[1][0]-t.part2[0][0],P=t.part2[1][1]-t.part2[0][1],v=P/f,w=f/s,Y=P/n;return{topDeltaX:s,topDeltaY:n,rightDeltaX:i,rightDeltaY:a,rightPixelDeltaX:h,leftDeltaX:d,leftDeltaY:u,leftPixelDeltaX:D,topPixelDeltaX:e,topPixelDeltaY:o,bottomDeltaX:f,bottomDeltaY:P,bottomPixelDeltaY:v,topBottomCoefX:w,topBottomCoefY:Y}}function b(r){const t=r.sort((e,o)=>e[1]-o[1]),s=t.slice(0,2).sort((e,o)=>e[0]-o[0]),n=t.slice(2,4).sort((e,o)=>e[0]-o[0]);return{part1:s,part2:n}}function L(r){const t=r.sort((e,o)=>e[1]-o[1]),s=t.slice(0,2).sort((e,o)=>e[0]-o[0]),n=t.slice(2,4).sort((e,o)=>o[0]-e[0]);return[...s,...n]}function T(r,t){var s=t[0]-r[0],n=t[1]-r[1],e=Math.sqrt(s*s+n*n);return e}function I(r,t,s){const n=b(r),e=X(r),o=s-n.part1[0][1],i=s-n.part1[1][1],a=o*e.leftPixelDeltaX,h=i*e.rightPixelDeltaX;let d={x:n.part1[0][0]+a,y:s},u={x:n.part1[1][0]+h,y:s},D=d.x-t,f=u.x-t;return{left:D,right:f}}const g=document.querySelector("canvas"),l=g.getContext("2d"),y=document.querySelector("img");window.save=q;let[p,m]=[0,0];setTimeout(()=>{g.width=y.offsetWidth,g.height=y.offsetHeight,x=""},250);const c=O();let x="";setInterval(()=>{c.toString()+p+m!=x&&(x=c.toString()+p+m,l.lineWidth=1,l.drawImage(y,0,0),l.strokeStyle="#f00",c.forEach(r=>{l.stroke(),l.beginPath(),l.fillText(r[0]+", "+r[1],r[0],r[1])}),C(c,"#00f"),E(l,c,p,m))},1e3/60);let S=!1;g.onmousedown=()=>S=!0;g.onmouseup=()=>S=!1;g.onmousemove=r=>{p=r.offsetX,m=r.offsetY;const t=c.reduce((s,n,e)=>{const o=T([p,m],n);return o<s.dis?{dis:o,index:e}:s},{dis:2e4,index:-1});S&&t.dis<20&&(c[t.index]=[p,m])};function C(r,t,s){l.beginPath(),l.strokeStyle=t??"#f00",l.fillStyle=s??"#0000",L(r).forEach((n,e)=>{l.lineTo(n[0],n[1])}),l.closePath(),l.stroke(),l.fill(),l.beginPath()}function O(){const r=window.localStorage.getItem("points");return r?r.split(",").reduce((t,s)=>{const n=t.length-1;return t[n].push(parseInt(s)),t[n].length==2&&t.push([]),t},[[]]).slice(0,4):[[10,10],[30,30],[30,10],[10,30]]}function q(){window.localStorage.setItem("points",c.toString())}function B(r,t){let s=r.map(D=>D.map(f=>f)),n=b(s),[e]=n.part1,[o]=n.part2;const i=X(s);let a=e[0]+i.topDeltaX*t,h=e[1]+i.topDeltaY*t,d=o[0]+i.bottomDeltaX*t,u=o[1]+i.bottomDeltaY*t;return[[a,h],[d,u]]}function E(r,t,s,n,e){const o=I(t,s,n),i=o.left-o.right,a=B(t,o.left/i);r.beginPath(),r.strokeStyle=e??"#f80",r.moveTo(a[0][0],a[0][1]),r.lineTo(a[1][0],a[1][1]),r.stroke(),r.beginPath()}
